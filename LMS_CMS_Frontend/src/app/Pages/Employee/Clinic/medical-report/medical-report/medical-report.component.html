<div>
    <!-- Header -->
    <div class="flex justify-between">
        <h1 class="primaryTxt font-bold text-2xl leading-9">
            Medical Report
        </h1>
    </div>

    <!-- Filter Controls -->
    <div class="my-5 flex flex-wrap md:flex-nowrap items-end space-x-0 md:space-x-6 space-y-4 md:space-y-0 mb-6">
        <!-- School Selector -->
        <div class="w-full md:w-1/4">
            <label class="block mb-2 text-sm font-medium text-gray-900" for="school">School</label>
            <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full" id="school"
                [(ngModel)]="selectedSchool" (ngModelChange)="onSchoolChange()" required>
                <option [ngValue]="null" disabled selected hidden>Choose School</option>
                <option *ngFor="let school of schools" [ngValue]="school.id">{{ school.name }}</option>
            </select>
        </div>

        <!-- Grade Selector -->
        <div class="w-full md:w-1/4">
            <label class="block mb-2 text-sm font-medium text-gray-900" for="grade">Grade</label>
            <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full" id="grade"
                [(ngModel)]="selectedGrade" (ngModelChange)="onGradeChange()" [disabled]="!selectedSchool" required>
                <option [ngValue]="null" disabled selected hidden>Choose Grade</option>
                <option *ngFor="let grade of grades" [ngValue]="grade.id">{{ grade.name }}</option>
            </select>
        </div>

        <!-- Class Selector -->
        <div class="w-full md:w-1/4">
            <label class="block mb-2 text-sm font-medium text-gray-900" for="class">Class</label>
            <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full" id="class"
                [(ngModel)]="selectedClass" (ngModelChange)="onClassChange()" [disabled]="!selectedGrade" required>
                <option [ngValue]="null" disabled selected hidden>Choose Class</option>
                <option *ngFor="let class of classes" [ngValue]="class.id">{{ class.name }}</option>
            </select>
        </div>

        <!-- View Report Button -->
        <div class="w-full md:w-1/6 flex justify-end mt-4 md:mt-0">
            <button class="p-3 font-medium text-xl rounded-lg" (click)="viewReport()"
                [disabled]="!selectedSchool || !selectedGrade || !selectedClass" [ngClass]="{
                    'bg-gray-100 text-gray-300': !selectedSchool || !selectedGrade || !selectedClass,
                    'secondaryBg text-white': selectedSchool && selectedGrade && selectedClass
                }">
                View Report
            </button>
        </div>
    </div>

    <!-- Tabs -->
    <div class="flex space-x-4 mb-6">
        <button *ngFor="let tab of tabs" (click)="selectTab(tab)" [ngClass]="{
            'bg-[#089B41] text-white': selectedTab === tab,
            'bg-gray-200 text-gray-700': selectedTab !== tab
        }" class="px-4 py-3 text-sm font-medium rounded-sm focus:outline-none transition-colors duration-200">
            {{ tab }}
        </button>
    </div>

    <!-- Export Buttons -->
    <div *ngIf="showTable" class="mb-5 flex justify-end space-x-4">
        <img class="w-5 cursor-pointer" src="Icons/Excel.png" (click)="exportToExcel()" title="Export to Excel">
        <img class="w-5 cursor-pointer" src="Icons/PDF.png" (click)="exportToPDF()" title="Export to PDF">
        <img class="w-5 cursor-pointer" src="Icons/Print.png" (click)="printTable()" title="Print Report">
    </div>

    <!-- Table -->
    <div *ngIf="showTable" class="mt-5 overflow-x-auto rounded-2xl border border-[#BDBDBD]">
        <table class="w-full tabe inset-0 bg-[#EBEBEB] text-left text-[#6F6F6F]">
<!-- In your template, replace the table header section with: -->
<thead class="bg-[#EBEBEB] text-sm md:text-base border border-[#BDBDBD] border-t-0 border-l-0">
    <tr>
        <th *ngFor="let header of getCurrentHeaders()"
            class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
            {{ header }}
        </th>
    </tr>
</thead>
            <tbody>
                <tr *ngIf="tableData.length === 0">
                    <td [attr.colspan]="pdfTableHeaders.length"
                        class="bg-white px-4 py-2 h-[72px] text-center border-t border-gray-300 text-xs md:text-sm">
                        No Data Found
                    </td>
                </tr>

                <tr *ngFor="let row of tableData; let i = index" [ngClass]="{ 
                        'bg-[#F7F7F7]': i % 2 === 1, 
                        'bg-white': i % 2 !== 1
                    }" class="border-t border-gray-300 text-xs md:text-sm">
                    <td *ngFor="let header of pdfTableHeaders"
                        class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
                        {{ getCellValue(row, header) }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Hidden PDF container -->
    <div class="absolute -top-[9999px] -left-[9999px]">
        <div id="pdfPrintData" class="hidden">
            <app-pdf-print *ngIf="showPDF" [school]="pdfSchoolData" [fileName]="pdfFileName" [Title]="pdfTitle"
                [infoRows]="pdfInfoRows" [tableHeaders]="pdfTableHeaders" [tableData]="pdfTableData" #pdfComponentRef>
            </app-pdf-print>
        </div>
    </div>
</div>