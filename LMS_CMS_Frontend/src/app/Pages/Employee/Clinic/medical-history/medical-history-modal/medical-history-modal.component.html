<div class="relative bg-white rounded-2xl p-8 w-[669px] max-h-[90vh] overflow-y-auto">
    <!-- Close Icon -->
    <div class="flex justify-between items-center w-full">
        <!-- Modal Header -->
        <h1 *ngIf="!editMode" class="font-semibold text-2xl leading-9">Create Medical History</h1>
        <h1 *ngIf="editMode" class="font-semibold text-2xl leading-9">Edit Medical History</h1>
        <button (click)="closeModal()" class="text-gray-400 hover:text-gray-900 transition duration-200">
            <i class="fa-solid fa-xmark text-2xl"></i>
        </button>
    </div>

    <!-- Modal Content -->
    <div class="mt-4 bg-[#F7F7F7] rounded-[24px] p-[16px_24px] w-[573px] gap-[20px] mx-auto overflow-y-auto">
        <!-- School -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">School</h6>
        <div class="flex flex-col">
            <select [(ngModel)]="medicalHistory.schoolId"
                (change)="onSchoolChange($event); clearValidationError('schoolId')"
                class="rounded-lg border border-solid border-gray-300 py-1 overflow-y-auto w-full h-[45px] mb-3">
                <option [value]="0" disabled selected hidden>Choose School</option>
                <option *ngFor="let school of schools" [value]="school.id">{{ school.name }}</option>
            </select>
            <span *ngIf="validationErrors['schoolId']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['schoolId'] }}
            </span>
        </div>

        <!-- Grade -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">Grade</h6>
        <div class="flex flex-col">
            <select [(ngModel)]="medicalHistory.gradeId"
                (change)="onGradeChange($event); clearValidationError('gradeId')"
                class="rounded-lg border border-solid border-gray-300 py-1 overflow-y-auto w-full h-[45px] mb-3"
                [disabled]="!medicalHistory.schoolId">
                <option [value]="0" disabled selected hidden>Choose Grade</option>
                <option *ngFor="let grade of grades" [value]="grade.id">{{ grade.name }}</option>
            </select>
            <span *ngIf="validationErrors['gradeId']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['gradeId'] }}
            </span>
        </div>

        <!-- Class -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">Class</h6>
        <div class="flex flex-col">
            <select [(ngModel)]="medicalHistory.classRoomID"
                (change)="onClassChange($event); clearValidationError('classRoomID')"
                class="rounded-lg border border-solid border-gray-300 py-1 overflow-y-auto w-full h-[45px] mb-3"
                [disabled]="!medicalHistory.gradeId">
                <option [value]="0" disabled selected hidden>Choose Class</option>
                <option *ngFor="let class of classes" [value]="class.id">{{ class.name }}</option>
            </select>
            <span *ngIf="validationErrors['classRoomID']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['classRoomID'] }}
            </span>
        </div>

        <!-- Student -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">Student</h6>
        <div class="flex flex-col">
<select [(ngModel)]="medicalHistory.studentId" (change)="clearValidationError('studentId')"
    class="rounded-lg border border-solid border-gray-300 py-1 overflow-y-auto w-full h-[45px] mb-3"
    [disabled]="!medicalHistory.classRoomID">
    <option [value]="0" disabled selected hidden>Choose Student</option>
    <option *ngFor="let student of students" [value]="student.id" [selected]="medicalHistory.studentId === student.id">
        {{ student.name }}
    </option>
</select>
            <span *ngIf="validationErrors['studentId']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['studentId'] }}
            </span>
        </div>

        <!-- Details -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">Details</h6>
        <div class="flex flex-col">
            <textarea [(ngModel)]="medicalHistory.details" (input)="clearValidationError('details')"
                class="w-full h-[100px] rounded-lg border border-solid border-gray-300 px-2 py-1 mb-3 resize-none"
                placeholder="Enter Details"></textarea>
            <span *ngIf="validationErrors['details']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['details'] }}
            </span>
        </div>

        <!-- Permanent Drug -->
        <h6 class="font-medium text-base leading-6 mb-1 mt-3">Permanent Drug</h6>
        <div class="flex flex-col">
            <textarea [(ngModel)]="medicalHistory.permanentDrug" (input)="clearValidationError('permanentDrug')"
                class="w-full h-[100px] rounded-lg border border-solid border-gray-300 px-2 py-1 mb-3 resize-none"
                placeholder="Enter perm"></textarea>
            <span *ngIf="validationErrors['permanentDrug']" class="text-red-500 ml-3 font-normal">
                {{ validationErrors['permanentDrug'] }}
            </span>
        </div>

        <!-- FirstReport File Upload -->
        <div class="flex flex-col mb-4 w-full">
            <label class="primaryTxt font-medium text-base leading-6 mb-1 mt-3">First Report</label>
            <div class="bg-[#F6F6F6] flex items-center space-x-4 w-full rounded-md border-dashed mb-4 border-2">
                <div class="flex justify-center w-full">
                    <label for="firstReportUpload" class="cursor-pointer flex flex-col items-center rounded-xl px-6 py-3 lg:py-5">
                        <img *ngIf="!firstReportPreview" src="Images/Icon frame.png" class="w-1/4" alt="Upload Icon">
                        <img *ngIf="firstReportPreview" [src]="firstReportPreview" class="w-1/3 object-cover" alt="Uploaded Preview">
                        <p class="font-normal text-xs md:text-sm text-[#8E8E93] mt-3">
                            <span class="secondaryTxt">Click to Upload</span>
                        </p>
                        <p class="font-normal text-xs md:text-sm text-[#8E8E93]">(Max. File size: 25 MB)</p>
                    </label>
                    <input id="firstReportUpload" type="file" class="hidden" accept="image/*,video/*"
                        (change)="onFileUpload($event, 'firstReport')" />
                </div>
            </div>
            <span *ngIf="validationErrors['firstReport']" class="text-red-500 font-normal text-xs md:text-sm">
                {{ validationErrors['firstReport'] }}
            </span>
        </div>

        <!-- SecReport File Upload -->
        <div class="flex flex-col mb-4 w-full">
            <label class="primaryTxt font-medium text-base leading-6 mb-1 mt-3">Second Report</label>
            <div class="bg-[#F6F6F6] flex items-center space-x-4 w-full rounded-md border-dashed mb-4 border-2">
                <div class="flex justify-center w-full">
                    <label for="secReportUpload" class="cursor-pointer flex flex-col items-center rounded-xl px-6 py-3 lg:py-5">
                        <img *ngIf="!secReportPreview" src="Images/Icon frame.png" class="w-1/4" alt="Upload Icon">
                        <img *ngIf="secReportPreview" [src]="secReportPreview" class="w-1/3 object-cover" alt="Uploaded Preview">
                        <p class="font-normal text-xs md:text-sm text-[#8E8E93] mt-3">
                            <span class="secondaryTxt">Click to Upload</span>
                        </p>
                        <p class="font-normal text-xs md:text-sm text-[#8E8E93]">(Max. File size: 25 MB)</p>
                    </label>
                    <input id="secReportUpload" type="file" class="hidden" accept="image/*,video/*"
                        (change)="onFileUpload($event, 'secReport')" />
                </div>
            </div>
            <span *ngIf="validationErrors['secReport']" class="text-red-500 font-normal text-xs md:text-sm">
                {{ validationErrors['secReport'] }}
            </span>
        </div>

        <div class="flex justify-end w-full pt-6">
            <button (click)="saveMedicalHistory()" [disabled]="isSaving"
                class="bg-[#089B41] text-white font-medium px-5 py-3 rounded-lg transition duration-200 w-full">
                {{ isSaving ? 'Saving...' : 'Submit' }}
            </button>
        </div>
    </div>
</div>