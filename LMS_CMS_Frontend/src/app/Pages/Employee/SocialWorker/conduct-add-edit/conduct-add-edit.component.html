<div class="flex justify-between items-center">
    <div class="flex justify-between items-center space-x-5 rtl:space-x-reverse">
        <i class="fa-solid fa-chevron-left cursor-pointer" (click)="moveToConduct()"></i>
        <h1 class="primaryTxt font-semibold text-2xl leading-9">
            {{mode === 'Create' ? ('Create Conduct'|translate): ('Edit Conduct'|translate)}}
        </h1>
    </div>
    <button [disabled]="isLoading" class="secondaryBg text-white font-medium px-4 py-2 rounded-lg" (click)="Save()">
        <span *ngIf="!isLoading"> {{ 'Save' | translate }}</span>
        <i *ngIf="isLoading" class="fas fa-spinner fa-spin"></i>
    </button>
</div>

<div class="mt-6 mb-4 rounded-3xl flex justify-between flex-wrap">
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2 primaryTxt" for="date"> {{ 'Date' | translate }}</label>
        <input id="date" type="date" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
            placeholder=" {{ 'Enter User date' | translate }}" [(ngModel)]="Data.date"
            (ngModelChange)="onInputValueChange({ field: 'date', value: $event })" />
        <span *ngIf="validationErrors['date']" class="text-red-500 ml-3 font-normal">{{ validationErrors["date"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="studentID">{{ 'School' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="studentID"
            [(ngModel)]="Data.schoolID" (change)="GetGrades(); GetConductTypes();" (ngModelChange)="onInputValueChange({ field: 'schoolID', value: $event })">
            <option [value]="0" disabled selected hidden> {{ 'Choose' | translate }} {{ 'School' | translate }}</option>
            <option *ngFor="let school of schools" [value]="school.id">{{ school.name }}</option>
            <option *ngIf="schools.length === 0" disabled selected> {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['schoolID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["schoolID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="gradeID"> {{ 'Grade' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="gradeID"
            [(ngModel)]="Data.gradeID" [disabled]="!Data.schoolID" (change)="GetClasses();" (ngModelChange)="onInputValueChange({ field: 'gradeID', value: $event })">
            <option [value]="0" disabled selected hidden>  {{ 'Choose' | translate }} {{ 'Grade' | translate }}</option>
            <option *ngFor="let stu of grades" [value]="stu.id">{{ stu.name }}</option>
            <option *ngIf="grades.length === 0" disabled selected> {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['gradeID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["gradeID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="classroomID"> {{ 'Classroom' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="classroomID"
            [(ngModel)]="Data.classroomID" [disabled]="!Data.gradeID" (change)="GetStudents();" (ngModelChange)="onInputValueChange({ field: 'classroomID', value: $event })">
            <option [value]="0" disabled selected hidden> {{ 'Choose' | translate }} {{ 'Classroom' | translate }}</option>
            <option *ngFor="let class of classes" [value]="class.id">{{ class.name }}</option>
            <option *ngIf="classes.length === 0" disabled selected>  {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['classroomID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["classroomID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="studentID">{{ 'Student' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="studentID"
            [(ngModel)]="Data.studentID" [disabled]="!Data.gradeID" (ngModelChange)="onInputValueChange({ field: 'studentID', value: $event })">
            <option [value]="0" disabled selected hidden> {{ 'Choose' | translate }} {{ 'Student' | translate }}</option>
            <option *ngFor="let stu of students" [value]="stu.id">{{ stu.en_name }}</option>
            <option *ngIf="students.length === 0" disabled selected> {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['studentID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["studentID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="conductTypeID"> {{ 'Conduct Type' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="conductTypeID"
            [(ngModel)]="Data.conductTypeID" [disabled]="!Data.schoolID" (ngModelChange)="onInputValueChange({ field: 'conductTypeID', value: $event })">
            <option [value]="0" disabled selected hidden>  {{ 'Choose' | translate }} {{ 'Conduct Type' | translate }}</option>
            <option *ngFor="let type of conductTypes" [value]="type.id">{{ type.en_name }}</option>
            <option *ngIf="conductTypes.length === 0" disabled selected> {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['conductTypeID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["conductTypeID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-[49%]">
        <label class="mb-2" for="procedureTypeID"> {{ 'Procedure Type' | translate }}</label>
        <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="procedureTypeID"
            [(ngModel)]="Data.procedureTypeID" (ngModelChange)="onInputValueChange({ field: 'procedureTypeID', value: $event })">
            <option [value]="0" disabled selected hidden> {{ 'Choose' | translate }} {{ 'Procedure Type' | translate }}</option>
            <option *ngFor="let type of proceduresType" [value]="type.id">{{ type.name }}</option>
            <option *ngIf="proceduresType.length === 0" disabled selected> {{ 'No Data Found' | translate }}</option>
        </select>
        <span *ngIf="validationErrors['procedureTypeID']" class="text-red-500 ml-3 font-normal">{{ validationErrors["procedureTypeID"]}}</span>
    </div>
    <div class="flex flex-col mb-4 w-full">
        <label class="mb-2 primaryTxt" for="Details"> {{ 'Details' | translate }}</label>
        <textarea id="Details" type="text"
            class="w-full h-[100px] rounded-lg border border-solid border-gray-300 px-2 py-1 mb-3 resize-none"
            placeholder="{{ 'Enter' | translate }} {{ 'Details' | translate }}" [(ngModel)]="Data.details"
            (ngModelChange)="onInputValueChange({ field: 'details', value: $event })"></textarea>
        <span *ngIf="validationErrors['details']" class="text-red-500 ml-3 font-normal">{{validationErrors['details']}}</span>
    </div>

    <div class="flex align-middle space-x-2 rtl:space-x-reverse mb-4 w-full">
        <input type="checkbox" id="isSendSMSToParent" class="w-5 h-5" [(ngModel)]="Data.isSendSMSToParent">
        <label class="mb-2" for="isSendSMSToParent">{{ 'Is Send SMS To Parent' | translate }}</label>
    </div>

    <div *ngIf="Data.newFile" class=" rounded-md border-2 w-[30%] px-6 py-3 lg:py-5">
        <div class="flex justify-between items-center">
            <div class="flex items-center space-x-2 rtl:space-x-reverse">
                <i class="fa-solid fa-file"></i>
                <p class="text-sm font-medium text-gray-700 truncate max-w-[150px]">
                    {{ Data.newFile.name }}
                </p>
            </div>
        </div>
        <p class="text-sm font-medium text-gray-700 mb-4"> {{'bytes'| translate }}</p>
        <p class="secondaryTxt cursor-pointer hover:underline mt-2" (click)="openFile(Data.newFile)">
             {{ 'Click to' | translate }} {{ 'View' | translate }}
        </p>
    </div>

    <div *ngIf="mode == 'Edit'&& Data.file && !Data.newFile" class=" rounded-md border-dashed border-2 w-[30%] px-6 py-3 lg:py-5">
        <p class="font-semibold text-sm text-[#6F6F6F] mb-3"> {{ 'File' | translate }}</p>
        <div class="flex justify-between items-center">
            <div class="flex items-center space-x-2 rtl:space-x-reverse">
                <i class="fa-solid fa-file"></i>
                <p class="text-sm font-medium text-gray-700 truncate max-w-[150px]">
                    {{ Data.file}}
                </p>
            </div>
        </div>
        <p class="secondaryTxt cursor-pointer hover:underline mt-2" (click)="openUrl(Data.file)">
             {{ 'Click to' | translate }} {{ 'View' | translate }}
        </p>
    </div>

    <div class="w-full mt-4">
        <div
            class="bg-[#F6F6F6] flex items-center space-x-4 rtl:space-x-reverse w-full rounded-md border-dashed border-2">
            <div class="flex justify-center w-full">
                <label for="newFile" class="cursor-pointer flex flex-col items-center rounded-xl px-6 py-3 lg:py-5">
                    <img *ngIf="!Data.file && !Data.newFile" src="Images/Icon frame.png" class="w-1/4">
                    <img *ngIf="Data.newFile" src="Images/FileAttached.png" class="w-1/4">
                    <img *ngIf="!Data.newFile && Data.file" [src]="Data.file" class="w-1/3 object-cover">
                    <p class="font-normal text-xs md:text-sm text-[#8E8E93] mt-3"><span class="secondaryTxt">
                            {{ 'Click to' | translate }} {{ 'Upload' | translate }}
                        </span></p>
                    <p class="font-normal text-xs md:text-sm text-[#8E8E93]"> {{ '(Max. File size: 25 MB)' | translate
                        }}</p>
                </label>
                <input id="newFile" type="file" class="hidden" (change)="onImageFileSelected($event)"
                    accept=".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.txt,.xls,.xlsx,.csv,.mp4,.avi,.mkv,.mov"/>
            </div>
        </div>
        <span *ngIf="validationErrors['newFile']" class="text-red-500  font-normal text-xs md:text-sm">{{
            validationErrors['newFile'] }}</span>
    </div>
</div>