<div class="flex justify-between items-center">
  <div class="flex justify-between items-center space-x-5 rtl:space-x-reverse">
    <i class="fa-solid fa-chevron-left cursor-pointer" (click)="moveToEmployee()"></i>
    <h1 class="font-semibold text-2xl leading-9">
      {{Data.en_name}}
    </h1>
  </div>
  <button [disabled]="isLoading" class="secondaryBg text-white font-medium px-4 py-2 rounded-lg mt-2" (click)="Save()">
    <span *ngIf="!isLoading"> {{ 'Save' | translate }}</span>
    <i *ngIf="isLoading" class="fas fa-spinner fa-spin"></i>
  </button>
</div>

<div class="mt-6 mb-4 rounded-3xl flex justify-between flex-wrap py-3">
  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="name">{{ 'User Name' | translate }}</label>
    <input id="name" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      (ngModelChange)=" onInputValueChange({ field: 'user_Name', value: $event })"
      placeholder="{{ 'Enter User Name' | translate }}" [(ngModel)]="Data.user_Name " />

    <span *ngIf="validationErrors['user_Name']" class="text-red-500 ml-3 font-normal">{{ validationErrors["user_Name"]
      }}</span>
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="Address"> {{ 'Address' | translate }}</label>
    <input id="Address" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter Address' | translate }}" [(ngModel)]="Data.address" />
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="Phone"> {{ 'Phone' | translate }}</label>
    <input id="phone" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      (input)="validateNumberOnly($event,'phone')" placeholder="{{ 'Enter User phone' | translate }}"
      [(ngModel)]="Data.phone" />
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="mobile"> {{ 'Mobile Number' | translate }}</label>
    <input id="mobile" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      (input)="validateNumberOnly($event,'mobile')" placeholder="{{ 'Enter User mobile' | translate }}"
      [(ngModel)]="Data.mobile" />
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="National">{{'National Id'| translate }}</label>
    <input id="National" (input)="validateNumberOnly($event,'nationalID')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter National Id' | translate }}" [(ngModel)]="Data.nationalID" />
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="passportNumber"> {{ 'Passport Number' | translate }}</label>
    <input id="passportNumber" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter User passportNumber' | translate }}" [(ngModel)]="Data.passportNumber" />
  </div>


  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="residenceNumber"> {{ 'Residence number' | translate }}</label>
    <input id="residenceNumber" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter User residenceNumber' | translate }}" [(ngModel)]="Data.residenceNumber" />
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="birthdayDate"> {{ 'BirthDay Date' | translate }}</label>
    <input id="birthdayDate" type="date" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter User birthdayDate' | translate }}" [(ngModel)]="Data.birthdayDate" />
  </div>

  <div class="flex flex-col w-[49%] mb-4">
    <label class="mb-2" for="Nationality"> {{ 'Choose Nationality' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Nationality"
      [(ngModel)]="Data.nationality">
      <option [value]="null" disabled selected hidden> {{ 'Choose Nationality' | translate }}</option>
      <option *ngFor="let National of nationalities" [value]="National.id">{{ National.name }}</option>
      <option *ngIf="nationalities.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col mb-4 w-[49%]">
    <label class="mb-2 primaryTxt" for="hireDate"> {{ 'Hire Date' | translate }}</label>
    <input id="hireDate" type="date" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter Date' | translate }}" [(ngModel)]="Data.hireDate" />
  </div>

  <div class="flex w-full space-x-5 rtl:space-x-reverse items-center mb-4">
    <div class="flex w-[20%] space-x-5 rtl:space-x-reverse items-center mb-4">
      <input type="checkbox" class="w-5 h-5" id="End" (change)="onIsActiveChange($event)" [checked]="EndDate">
      <label for="End" class="text-sm"> {{ 'End Date' | translate }}</label>
    </div>

    <div *ngIf="EndDate==true" class="flex flex-col mb-4 w-[33%]">
      <label class="mb-2 primaryTxt" for="dateOfLeavingWork"> {{ 'Date of Leaving Work' | translate }}</label>
      <input id="dateOfLeavingWork" type="date" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
        placeholder="{{ 'Enter date Of Leaving Work' | translate }}" [(ngModel)]="Data.dateOfLeavingWork" />
    </div>

    <div *ngIf="EndDate==true" class="flex flex-col w-[33%] mb-4">
      <label class="mb-2" for="Reasons"> {{ 'Choose Reasons For Leaving Work' | translate }}</label>
      <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Reasons"
        [(ngModel)]="Data.reasonOfLeavingID">
        <option [value]="null" disabled selected hidden> {{ 'Choose Reason' | translate }}</option>
        <option *ngFor="let reason of Reasons" [value]="reason.id">{{ reason.name }}</option>
        <option *ngIf="Reasons.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
      </select>
    </div>
  </div>

  <div class="flex w-full space-x-5 rtl:space-x-reverse items-center mb-4">
    <div class="flex flex-col w-[73%]">
      <label class="mb-2 primaryTxt" for="monthSalary"> {{ 'Month Salary' | translate }}</label>
      <input id="monthSalary" type="text" class="rounded-lg border border-solid border-gray-300 px-4 py-3"
        (input)="validateNumber($event,'monthSalary')" placeholder="{{ 'Enter monthSalary' | translate }}"
        [(ngModel)]="Data.monthSalary" />
    </div>

    <div class="flex w-[23%] space-x-5 rtl:space-x-reverse items-center mt-5">
      <input type="checkbox" class="w-5 h-5" id="Attendance" (change)="onHasAttendanceChange($event)"
        [checked]="Data.hasAttendance">
      <label for="Attendance" class="text-sm"> {{ 'Has Attendance' | translate }}</label>
    </div>
  </div>

  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="attendanceTime"> {{ 'Attendance Time' | translate }}</label>
    <div class="flex items-center gap-2">
      <input (ngModelChange)=" onInputValueChange({ field: 'attendanceTime', value: $event })" id="attendanceHours"
        (input)="validateNumberOnly($event)" class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]"
        placeholder="{{ 'HH' | translate }}" [(ngModel)]="attendanceTime.hours" type="number" min="1" max="12" />
      <input (ngModelChange)=" onInputValueChange({ field: 'attendanceTime', value: $event })" id="attendanceMinutes"
        (input)="validateNumberOnly($event)" class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]"
        placeholder="{{ 'MM' | translate }}" type="number" [(ngModel)]="attendanceTime.minutes" min="0" max="59" />
      <select (ngModelChange)=" onInputValueChange({ field: 'attendanceTime', value: $event })" id="attendancePeriod"
        class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]" [(ngModel)]="attendanceTime.periods">
        <option value="AM"> {{ 'AM' | translate }}</option>
        <option value="PM"> {{ 'PM' | translate }}</option>
      </select>
    </div>
  </div>

  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="departureTime"> {{ 'Departure Time' | translate }}</label>
    <div class="flex items-center gap-2">
      <input (ngModelChange)=" onInputValueChange({ field: 'departureTime', value: $event })" id="departureHours"
        (input)="validateNumberOnly($event)" class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]"
        placeholder="{{ 'HH' | translate }}" type="number" [(ngModel)]="departureTime.hour" min="1" max="12" />
      <input (ngModelChange)=" onInputValueChange({ field: 'departureTime', value: $event })" id="departureMinutes"
        (input)="validateNumberOnly($event)" class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]"
        placeholder="{{ 'MM' | translate }}" type="number" [(ngModel)]="departureTime.minute" min="0" max="59" />
      <select (ngModelChange)=" onInputValueChange({ field: 'departureTime', value: $event })" id="departurePeriod"
        class="rounded-lg border border-solid border-gray-300 px-4 py-3 w-[30%]" [(ngModel)]="departureTime.period">
        <option value="AM">{{ 'AM' | translate }}</option>
        <option value="PM">{{ 'PM' | translate }}</option>
      </select>
    </div>
    <span *ngIf="validationErrors['departureTime']" class="text-red-500 ml-3 font-normal">{{
      validationErrors["departureTime"] }}</span>
  </div>



  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="delayAllowance">{{ 'Delay Allowance (in minutes)' | translate }}</label>
    <input id="delayAllowance" (input)="validateNumber($event, 'delayAllowance')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter delayAllowance' | translate }}" [(ngModel)]="Data.delayAllowance" />
  </div>

  <div class="flex flex-col w-full mb-4">
    <label class="mb-2" for="Account"> {{ 'Account Number' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Account"
      [(ngModel)]="Data.accountNumberID">
      <option [value]='null' disabled selected hidden> {{ 'Account Number' | translate }}</option>
      <option *ngFor="let Acc of AccountNumbers" [value]="Acc.id">{{ Acc.name }}</option>
      <option *ngIf="AccountNumbers.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="annualLeaveBalance"> {{ 'Annual Leave Balance' | translate }}</label>
    <input id="annualLeaveBalance" (input)="validateNumber($event, 'annualLeaveBalance')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter annualLeaveBalance' | translate }}" [(ngModel)]="Data.annualLeaveBalance" />
  </div>
  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="casualLeavesBalance"> {{ 'Casual Leaves Balance' | translate }}</label>
    <input id="casualLeavesBalance" (input)="validateNumber($event, 'casualLeavesBalance')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter casualLeavesBalance' | translate }}" [(ngModel)]="Data.casualLeavesBalance" />
  </div>
  <div class="flex flex-col mb-4 w-[33%]">
    <label class="mb-2 primaryTxt" for="monthlyLeaveRequestBalance"> {{ 'Monthly Leave Request Balance' | translate
      }}</label>
    <input id="monthlyLeaveRequestBalance" (input)="validateNumber($event, 'monthlyLeaveRequestBalance')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3"
      placeholder="{{ 'Enter monthlyLeaveRequestBalance' | translate }}"
      [(ngModel)]="Data.monthlyLeaveRequestBalance" />
  </div>

  <div class="w-full mb-4">
    <div class="mt-5 overflow-x-auto rounded-2xl border border-[#BDBDBD]">
      <table class="w-full tabe inset-0 bg-[#EBEBEB] text-left text-[#6F6F6F]">
        <thead class="bg-[#EBEBEB] text-sm md:text-base border border-[#BDBDBD] border-t-0 border-l-0">
          <tr>
            <th class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
              {{ 'Vacation Type' | translate }}
            </th>
            <th class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
              {{ 'Balance' | translate }}
            </th>
          </tr>
        </thead>
        <tbody>
          <!-- No Data Row -->
          <tr *ngIf="Data.annualVacationEmployee.length === 0">
            <td colspan="3" class="bg-white px-4 py-2 h-[72px] text-center border-t border-gray-300 text-xs md:text-sm">
              {{ 'No Data Found' | translate }}
            </td>
          </tr>

          <!-- Data Rows -->
          <tr *ngFor="let row of Data.annualVacationEmployee; let i = index"
            [ngClass]="{ 'bg-[#F7F7F7]': i % 2 === 1, 'bg-white': i % 2 !== 1 }"
            class="border-t border-gray-300 text-xs md:text-sm">
            <td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
              {{ row.vacationTypeName }}
            </td>
            <td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
              <input id="balance" 
                class="rounded-lg border border-solid border-gray-300 px-4 py-3"
                [(ngModel)]="row.balance" />
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="flex flex-col w-[48%] mb-4">
    <label class="mb-2" for="Departments"> {{ 'Departments' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Departments"
      [(ngModel)]="Data.departmentID">
      <option [value]="null" disabled selected hidden> {{ 'Choose Department' | translate }}</option>
      <option *ngFor="let dept of departments" [value]="dept.id">{{ dept.name }}</option>
      <option *ngIf="departments.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col w-[48%] mb-4">
    <label class="mb-2" for="Category"> {{ 'Job Category' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Category"
      (change)="OnSelectJobCategory()" [(ngModel)]="Data.jobCategoryID">
      <option [value]="null" disabled selected hidden> {{ 'Choose Job Category' | translate }}</option>
      <option *ngFor="let job of JobCategories" [value]="job.id">{{ job.name }}</option>
      <option *ngIf="JobCategories.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col w-[48%] mb-4">
    <label class="mb-2" for="Jobs"> {{ 'Jobs' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Jobs"
      [(ngModel)]="Data.jobID" [disabled]="Data.jobCategoryID == 0 || Data.jobCategoryID == null"
      [ngClass]="{'bg-gray-300': Data.jobCategoryID == 0 || Data.jobCategoryID == null}">
      <option [value]="0" disabled selected hidden> {{ 'Choose Job' | translate }}</option>
      <option *ngFor="let job of Jobs" [value]="job.id">{{ job.name }}</option>
      <option *ngIf="Jobs.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col w-[48%] mb-4">
    <label class="mb-2" for="Degree"> {{ 'Academic Degree' | translate }}</label>
    <select class="rounded-lg border border-solid border-gray-300 px-4 py-3 overflow-y-auto" id="Degree"
      [(ngModel)]="Data.academicDegreeID">
      <option [value]="null" disabled selected hidden> {{ 'Choose Academic Degree' | translate }}</option>
      <option *ngFor="let Acc of academicDegree" [value]="Acc.id">{{ Acc.name }}</option>
      <option *ngIf="academicDegree.length === 0" disabled selected>{{ 'No Data Found' | translate }}</option>
    </select>
  </div>

  <div class="flex flex-col mb-4 w-[48%]">
    <label class="mb-2 primaryTxt" for="graduationYear"> {{ 'Graduation Year' | translate }}</label>
    <input id="graduationYear" (input)="validateNumberOnly($event, 'graduationYear')"
      class="rounded-lg border border-solid border-gray-300 px-4 py-3" placeholder="{{ 'Enter Year' | translate }}"
      [(ngModel)]="Data.graduationYear" min="1900" max="2099" />
  </div>

  <div class="flex flex-col w-full mb-4">
    <label class="mb-2 cursor-pointer" (click)="toggleDropdown()">
      {{ 'Working Days' | translate }}
    </label>
    <div class="relative">
      <div class="flex flex-wrap gap-2 mb-2 border border-solid border-gray-300 rounded-lg px-4 py-3"
        (click)="toggleDropdown()">
        <span *ngFor="let selected of selectedDays"
          class="mr-2 mb-1 bg-gray-200 px-3 py-1 rounded-full text-sm flex items-center">
          {{ selected.name }}
          <button type="button" class="ml-2 text-red-500 hover:text-red-700" (click)="removeDay(selected.id)">
            &times;
          </button>
        </span>

        <span *ngIf="selectedDays.length === 0" class="text-gray-400">
          {{ 'Select working days...' | translate }}
        </span>
      </div>

      <div
        class="absolute bg-white border border-solid border-gray-300 rounded-lg shadow-md w-full mt-1 max-h-48 overflow-y-auto z-10"
        *ngIf="isDropdownOpen">
        <ul>
          <li class="px-4 py-2 cursor-pointer hover:bg-gray-100" (click)="selectAllDay()">
            All Days
          </li>
          <li *ngFor="let day of days" class="px-4 py-2 cursor-pointer hover:bg-gray-100" (click)="selectDay(day)">
            {{ day.name }}
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="flex flex-col mb-4 w-full">
    <h6 class="font-medium text-base leading-6 mb-1 mt-3"> {{ 'Note' | translate }}</h6>
    <div class="flex justify-start gap-2 items-start">
      <div class="flex flex-col w-full">
        <textarea class="w-full h-[100px] rounded-lg border border-solid border-gray-300 px-2 py-1 mb-3 resize-none"
          [(ngModel)]="Data.note" placeholder="{{ 'Enter Note' | translate }}"></textarea>
      </div>
    </div>
  </div>

</div>

<div class="">
  <div class="flex justify-between">
    <h1 class="font-semibold text-2xl leading-9"> {{ 'Children`s' | translate }}</h1>
    <div class="flex justify-between items-center">
      <button (click)="Create()"
        class="rounded-lg secondaryBorder secondaryTxt px-4 py-3 flex items-center justify-center gap-2">
        {{ 'Add Child' | translate }}
      </button>
    </div>
  </div>

  <div>
    <div class="mt-5 overflow-x-auto rounded-2xl border border-[#BDBDBD]">
      <table class="w-full tabe inset-0 bg-[#EBEBEB] text-left text-[#6F6F6F]">
        <thead class="bg-[#EBEBEB] text-sm md:text-base border border-[#BDBDBD] border-t-0 border-l-0">
          <tr>
            <th class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
              {{ 'ID' | translate }}
            </th>
            <th class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
              {{ 'Name' | translate }}
            </th>
            <th class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
              {{ 'Actions' | translate }}
            </th>
          </tr>
        </thead>
        <tbody>
          <!-- No Data Row -->
          <tr *ngIf="TableData.length === 0">
            <td colspan="3" class="bg-white px-4 py-2 h-[72px] text-center border-t border-gray-300 text-xs md:text-sm">
              {{ 'No Data Found' | translate }}
            </td>
          </tr>

          <!-- Data Rows -->
          <tr *ngFor="let row of TableData; let i = index"
            [ngClass]="{ 'bg-[#F7F7F7]': i % 2 === 1, 'bg-white': i % 2 !== 1 }"
            class="border-t border-gray-300 text-xs md:text-sm">
            <td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
              {{ row.id === 0 ? '' : row.id }}
            </td>
            <td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
              {{ row.studentName }}
            </td>
            <td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
              <div class="flex space-x-4 rtl:space-x-reverse">
                <button (click)="DeleteChild(row.id)">
                  <i class="fa-regular fa-trash-can"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="default-modal" tabindex="-1" aria-hidden="true" [ngClass]="{ hidden: !isModalVisible }"
  class="fixed top-0 left-0 right-0 z-50 flex justify-center items-center w-full h-full bg-black/50">
  <div class="relative bg-white w-[669px] h-auto rounded-2xl p-12 gap-4 shadow-md">
    <!-- Close Icon -->
    <button (click)="closeModal()"
      class="absolute top-4 right-4 text-gray-400 hover:text-gray-900 transition duration-200">
      <i class="fa-solid fa-xmark text-2xl"></i>
    </button>

    <h1 class="font-semibold text-2xl leading-9">
      {{ 'Add Child' | translate }}
    </h1>
    <div class="mt-4 bg-[#F7F7F7] w-[573px] h-auto rounded-[24px] p-[16px_24px] gap-[20px]">
      <div class="flex flex-col mt-2 gap-2 items-start">

        <h6 class="font-medium text-base leading-6 mb-1 mt-3"> {{ 'National Id' | translate }}</h6>
        <input type="text" class="w-full h-[45px] rounded-lg border border-solid border-gray-300 px-2 mb-3"
          [(ngModel)]="NationalID" (ngModelChange)="SelectChild(NationalID)"
          placeholder="{{ 'Enter National Id' | translate }}" />
        <span *ngIf="IsNationalIsEmpty" class="text-red-500 ml-3 font-normal">{{IsNationalIsEmpty}}</span>

        <h6 class="font-medium text-base leading-6 mb-1 mt-3"> {{ 'Student' | translate }}</h6>
        <input type="text" class="w-full h-[45px] rounded-lg border border-solid border-gray-300 px-2 mb-3"
          [(ngModel)]="Student.user_Name" [disabled]="true" />

        <button class="secondaryBg text-white font-medium px-4 py-2 rounded-lg" (click)="CreateOREdit()">
          {{ 'Save' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>