<!-- electronic-invoice-detail.component.html -->
<div class="container mx-auto p-6 max-w-4xl">
    <!-- Header Section -->
    <div class="flex justify-between items-center mb-6 border-b pb-4">
        <button (click)="goBack()" class="flex items-center text-gray-600 hover:text-gray-800">
            <i class="fas fa-arrow-left mr-2"></i>
            Back to Invoices
        </button>

        <div class="flex gap-4">
            <button (click)="sendInvoice()" class="flex items-center gap-2 text-[#267C15] hover:text-[#1e6310]">
                <i class="fas fa-paper-plane"></i>
                <span>Send</span>
            </button>
            <button (click)="printInvoice()" class="flex items-center gap-2 text-[#267C15] hover:text-[#1e6310]">
                <i class="fas fa-print"></i>
                <span>Print</span>
            </button>
        </div>
    </div>

    <!-- Invoice Header -->
    <div class="text-center mb-8">
        <h1 class="text-2xl font-bold">Invoice {{invoice.invoiceNumber}}</h1>
        <div class="flex justify-between mt-4 text-sm">
            <div class="text-left">
                <p><strong>Name:</strong> {{invoice.studentName || 'N/A'}}</p>
                <p><strong>Address:</strong> {{invoice.studentAddress || 'N/A'}}</p>
            </div>
            <div class="text-right">
                <p><strong>Date:</strong> {{formatDate(invoice.date) || 'N/A'}}</p>
                <p><strong>Number:</strong> {{invoice.invoiceNumber || 'N/A'}}</p>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="text-center py-10">
        <i class="fas fa-spinner fa-spin text-2xl"></i>
        <p>Loading invoice details...</p>
    </div>

    <!-- Invoice Content -->
    <div *ngIf="invoice && !isLoading" class="bg-white rounded-lg shadow p-6">
        <!-- Products Table -->
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full border">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="py-3 px-4 text-left border">Product</th>
                        <th class="py-3 px-4 text-right border">Quantity</th>
                        <th class="py-3 px-4 text-right border">Price</th>
                        <th class="py-3 px-4 text-right border">Tax</th>
                        <th class="py-3 px-4 text-right border">Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of invoice.inventoryDetails" class="border-b">
                        <td class="py-3 px-4 border">{{item.itemName || 'N/A'}}</td>
                        <td class="py-3 px-4 text-right border">{{item.quantity}}</td>
                        <td class="py-3 px-4 text-right border">{{item.price }}</td>
                        <td class="py-3 px-4 text-right border">{{item.tax }}</td>
                        <td class="py-3 px-4 text-right border">{{item.totalPrice }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Invoice Summary -->
        <div class="flex justify-end">
            <div class="w-full md:w-1/2 lg:w-1/3 border-t-2 border-gray-200 pt-4">
                <h3 class="text-lg font-semibold mb-4">Invoice Summary</h3>
                <div class="flex justify-between mb-2">
                    <span class="font-medium">Sub total:</span>
                    <span>{{calculateSubtotal() }}</span>
                </div>
                <div class="flex justify-between mb-2">
                    <span class="font-medium">Taxes & Fees:</span>
                    <span>{{calculateTax() }}</span>
                </div>
                <div class="flex justify-between font-bold text-lg mt-4 pt-2 border-t">
                    <span>Total:</span>
                    <span>{{invoice.total }}</span>
                </div>
            </div>
        </div>

        <!-- Status and Validation -->
        <div class="mt-6 pt-4 border-t">
            <div class="flex items-center gap-2"
                [ngClass]="{'text-[#267C15]': invoice.isValid, 'text-red-500': !invoice.isValid}">
                <i class="fas" [class.fa-check-circle]="invoice.isValid" [class.fa-times-circle]="!invoice.isValid"></i>
                <span>{{invoice.isValid ? 'Valid' : 'Invalid'}} Invoice</span>
            </div>
            <div *ngIf="invoice.qrCode" class="mt-4">
                <p class="font-medium mb-2">QR Code:</p>
                <img [src]="invoice.qrCode" alt="Invoice QR Code" class="w-32 h-32">
            </div>
        </div>
    </div>
</div>