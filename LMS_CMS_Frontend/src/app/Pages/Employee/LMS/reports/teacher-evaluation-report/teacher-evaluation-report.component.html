<div class="flex justify-between mb-3">
    <h1 class="primaryTxt font-semibold text-2xl leading-9">{{ 'Teacher Evaluation Report' | translate }}</h1>
</div>

<!-- Filters Section -->
<div class="my-5 flex flex-wrap md:flex-nowrap items-end space-x-0 md:space-x-6 space-y-4 md:space-y-0 mb-6">
    <!-- Department Select -->
    <div class="w-full md:w-1/4">
        <label for="department" class="block mb-2 text-sm font-medium text-gray-900">{{'Department'| translate
            }}</label>
        <select id="department" [(ngModel)]="filterParams.departmentId" (change)="onDepartmentChange()"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full">
            <option [ngValue]="null" selected>{{'Select'| translate }} {{'All'| translate }}</option>
            <option *ngFor="let department of departments" [value]="department.id">
                {{ department.name }}
            </option>
        </select>
    </div>

    <!-- Employee Select -->
    <div class="w-full md:w-1/4">
        <label for="employee" class="block mb-2 text-sm font-medium text-gray-900">{{'Employee'| translate }}</label>
        <select id="employee" [(ngModel)]="filterParams.employeeId"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full"
            [disabled]="!filterParams.departmentId && departments.length > 0">
            <option [ngValue]="null" selected>{{'Select'| translate }} {{'All'| translate }}</option>
            <option *ngFor="let employee of employees" [value]="employee.id">
                {{ employee.en_name }}
            </option>
        </select>
    </div>

    <!-- Start Date -->
    <div class="w-full md:w-1/4">
        <label for="fromDate" class="block mb-2 text-sm font-medium text-gray-900">{{'Start Date'| translate }}</label>
        <input id="fromDate" type="date" [(ngModel)]="filterParams.fromDate"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full">
    </div>

    <!-- End Date -->
    <div class="w-full md:w-1/4">
        <label for="toDate" class="block mb-2 text-sm font-medium text-gray-900">{{'End Date'| translate }}</label>
        <input id="toDate" type="date" [(ngModel)]="filterParams.toDate"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5 w-full">
    </div>

    <!-- Action Buttons -->
    <div class="w-full md:w-1/6 flex justify-end space-x-2 mt-4 md:mt-0">
        <button class="p-3 font-medium text-xl rounded-lg bg-blue-600 text-white hover:bg-blue-700"
            (click)="generateReport()" [disabled]="isLoading">
            <span *ngIf="!isLoading">{{'Generate Report'| translate }}</span>
            <span *ngIf="isLoading">{{'Loading...'| translate }}</span>
        </button>

        <!-- <button class="p-3 font-medium text-xl rounded-lg bg-gray-300 text-gray-700 hover:bg-gray-400"
            (click)="clearFilters()">
            {{'Clear'| translate }}
        </button> -->
    </div>
</div>

<!-- Chart Section -->
<div *ngIf="evaluationData.length > 0" class="mt-8 bg-white p-6 rounded-lg shadow-md">
    <div class="chart-container" style="position: relative; height: 400px;">
        <canvas id="evaluationChart"></canvas>
    </div>
</div>

<!-- No Data Message -->
<div *ngIf="evaluationData.length === 0 && !isLoading" class="mt-8 bg-white p-6 rounded-lg shadow-md text-center">
    <p class="text-gray-500">{{'No evaluation data found for the selected criteria' | translate }}</p>
</div>

<!-- Loading Indicator -->
<div *ngIf="isLoading" class="mt-8 bg-white p-6 rounded-lg shadow-md text-center">
    <i class="fas fa-spinner fa-spin text-2xl text-blue-600"></i>
    <p class="mt-2 text-gray-600">{{'Loading evaluation data...' | translate }}</p>
</div>