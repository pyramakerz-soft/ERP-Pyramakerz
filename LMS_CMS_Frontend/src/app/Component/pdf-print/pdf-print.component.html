<div #printContainer class="p-5 text-sm font-sans" [dir]="isRtl ? 'rtl' : 'ltr'">
    <!-- Header Section -->
    <div class="flex justify-between items-center mb-6">
        <div class="w-[40%]">
            <p class="text-base font-semibold mb-1">
                {{ isRtl ? (school?.reportHeaderOneAr || school?.reportHeaderOneEn) : school?.reportHeaderOneEn }}
            </p>
            <p class="text-sm">
                {{ isRtl ? (school?.reportHeaderTwoAr || school?.reportHeaderTwoEn) : school?.reportHeaderTwoEn }}
            </p>
        </div>
        
        <div class="flex justify-center w-[15%]">
            <img *ngIf="school?.reportImage" [src]="school.reportImage"
                style="max-width: 120px; max-height: 120px; width: auto; height: auto;" />
        </div>
        
        <div class="w-[40%]" [class]="isRtl ? 'text-left' : 'text-right'">
            <p class="text-base font-semibold mb-1">
                {{ !isRtl ? (school?.reportHeaderOneAr || school?.reportHeaderOneEn) : school?.reportHeaderOneEn }}
            </p>
            <p class="text-sm">
                {{ !isRtl ? (school?.reportHeaderTwoAr || school?.reportHeaderTwoEn) : school?.reportHeaderTwoEn }}
            </p>
        </div>
    </div>

    <!-- Title -->
    <div class="my-10 flex justify-center">
        <h1 class="text-3xl font-bold tracking-wide">{{ Title | translate }}</h1>
    </div>

    <div class="my-10 space-y-4" dir="ltr">
        <div *ngFor="let info of infoRows" class="flex justify-between">
            <!-- English content (always left) -->
            <div class="w-1/2 text-left">
                <div [innerHTML]="info.keyEn" class="text-lg leading-8"></div>
            </div>
            <!-- Arabic content (always right) -->
            <div class="w-1/2 text-right" *ngIf="info.keyAr">
                <div [innerHTML]="info.keyAr" class="text-lg leading-8"></div>
            </div>
        </div>
    </div>

    <!-- Table Data With Header Array -->
    <div *ngIf="tableDataWithHeaderArray">
        <div *ngFor="let section of tableDataWithHeaderArray; let last = last" class="mb-8 pdf-table-container">
            <div class="border rounded-2xl shadow-sm overflow-hidden">
                <div class="p-3 bg-[#EBEBEB] summary-section">
                    <h5 class="primaryTxt font-semibold text-xl leading-9 mb-2">{{ section.header | translate }}</h5>
                    <table class="w-full table-fixed" [dir]="isRtl ? 'rtl' : 'ltr'">
                        <colgroup>
                            <col *ngFor="let header of getRtlHeaders(section.tableHeaders)" [ngStyle]="getColumnWidth(header, section.tableHeaders.length)">
                        </colgroup>
                        <thead>
                            <tr class="bg-gray-200 text-sm pdf-table-row">
                                <th *ngFor="let header of getRtlHeaders(section.tableHeaders)" 
                                    class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
                                    {{ header | translate }}
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="getRtlData(section.tableData, section.tableHeaders)?.length === 0">
                                <td [attr.colspan]="section.tableHeaders.length" class="text-center p-4">{{ 'No Data Found' | translate }}</td>
                            </tr>
                            <tr *ngFor="let row of getRtlData(section.tableData, section.tableHeaders); let i = index"
                                [ngClass]="{ 'bg-[#F7F7F7]': i % 2 === 1, 'bg-white': i % 2 !== 1 }">
                                <td *ngFor="let header of getRtlHeaders(section.tableHeaders)" 
                                    class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
                                    {{ row[header] }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div *ngIf="!last" class="table-section-separator border-t-2 border-gray-300 mt-6"></div>
        </div>
    </div>
    
    <!-- Regular Table Chunks -->
    <div *ngFor="let chunk of tableChunks" 
         class="mt-10 overflow-x-auto rounded-xl border border-[#BDBDBD] pdf-table-container"
         [ngClass]="{
           'small-table-section': isSmallTable(chunk.data),
           'large-table-section': isLargeTable(chunk.data),
           'table-section': !isSmallTable(chunk.data) && !isLargeTable(chunk.data)
         }">
        <table class="w-full inset-0 rounded-xl text-[#6F6F6F] table-fixed" [dir]="isRtl ? 'rtl' : 'ltr'">
            <colgroup>
                <col *ngFor="let header of chunk.headers" 
                     [ngStyle]="getColumnWidth(header, chunk.headers.length)">
            </colgroup>
            <thead>
                <tr class="bg-gray-200 text-sm pdf-table-row">
                    <th *ngFor="let header of chunk.headers" 
                        class="p-2 break-words text-nowrap">{{ header | translate }}</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngIf="chunk.data.length === 0" class="pdf-table-row">
                    <td [attr.colspan]="chunk.headers.length" class="text-center p-4">{{ 'No Data Found' | translate }}</td>
                </tr>
                <tr *ngFor="let row of chunk.data; let i = index" 
                    [ngClass]="{ 'bg-gray-100': i % 2 === 1 }"
                    class="pdf-table-row">
                    <td *ngFor="let header of chunk.headers" 
                        class="p-2 border break-words whitespace-normal align-top"
                        [ngClass]="{'details-cell': header.toLowerCase().includes('details')}">
                        {{ row[header] }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Notes Section - Fixed to show both languages -->
    <div class="my-6 space-y-4" *ngIf="PsNotes && PsNotes.length > 0">
        <div *ngFor="let note of PsNotes" class="flex justify-between border-t pt-4">
            <!-- English Note -->
            <div class="w-1/2" [class]="isRtl ? 'text-left pl-4' : 'text-left'">
                <div *ngIf="note.EnNote" [innerHTML]="note.EnNote" class="text-lg leading-8"></div>
            </div>
            
            <!-- Arabic Note -->
            <div class="w-1/2" *ngIf="note.ArNote" [class]="isRtl ? 'text-right pr-4' : 'text-right'">
                <div [innerHTML]="note.ArNote" class="text-lg leading-8"></div>
            </div>
        </div>
    </div>
</div>